import Configuration from "./configuration";
{{#if components.schemas}}
  import {
    {{#each components.schemas}}{{@key}}, {{/each}}
  } from "./model";
{{/if}}
import { request } from "./httpVerbs";

// {{info.title}}
{{!-- // {{info.description}} --}}
export default class Api {
  private config: Configuration;

  constructor(config: Configuration) {
    this.config = config;
  }

  {{#each paths}}
  {{setVar "path" @key}}
  {{#each this}}
    
    {{#if summary}}// {{summary}}{{/if}}
    {{#if description}}// {{description}}{{/if}}
    {{#each _sortedParameters}}
      // @param {{name}} {{description}}
    {{/each}}
    async {{operationId}}(
      {{#each _sortedParameters}}
        {{name}}{{#if _optional}}?{{/if}}: {{typeConvert schema}}{{#if schema.default}} = "{{schema.default}}"{{/if}},
      {{/each}}
    ): Promise<{{#if _response.schema}}{{typeConvert _response.schema}}{{else}}null{{/if}}> {
      return request(this.config, "{{@root.path}}", "{{@key}}", [
        {{#each _sortedParameters}}
          {
            name: "{{name}}",
            value: {{name}},
            type: "{{in}}"
          },
        {{/each}}
      ]);
    };

  {{/each}}  
  {{/each}}
}

